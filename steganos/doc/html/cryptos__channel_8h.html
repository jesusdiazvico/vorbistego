<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Steganography on Vorbis&#39; audio streams: lib/cryptos_channel.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lib/cryptos_channel.h File Reference</h1><code>#include &quot;<a class="el" href="cryptos__types_8h_source.html">cryptos_types.h</a>&quot;</code><br/>

<p><a href="cryptos__channel_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a7c1db6bf9f40ac05ecbf951309023000">CRYPTOS_SYNC_HEADER_LEN</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the number of bytes of the SYNC header field.  <a href="#a7c1db6bf9f40ac05ecbf951309023000"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a4b01da0a30c6c33719ba7a286d21843d">CRYPTOS_LENGTH_HEADER_LEN</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the number of bytes of the "length" header field.  <a href="#a4b01da0a30c6c33719ba7a286d21843d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a0a6fe10d58962c9689889c18376b7c92">CRYPTOS_IV_HEADER_LEN</a>&nbsp;&nbsp;&nbsp;16</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the number of bytes of the IV header field.  <a href="#a0a6fe10d58962c9689889c18376b7c92"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a382386d5c1b47427e64124cfc65908fd">CRYPTOS_EMISSION_HEADER_LEN</a>&nbsp;&nbsp;&nbsp;sizeof(uint64_t)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the number of bytes of the EMISSION header field.  <a href="#a382386d5c1b47427e64124cfc65908fd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a984f884b4ca70914b046f647f0b77c55">CRYPTOS_PACKET_HEADER_LEN</a>&nbsp;&nbsp;&nbsp;sizeof(uint64_t)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the number of bytes of the PACKET header field.  <a href="#a984f884b4ca70914b046f647f0b77c55"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a2288de8094acf582dca4ee1f0cdd2e97">CRYPTOS_MAX_DATA</a>&nbsp;&nbsp;&nbsp;0xFFFFFFFF</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the maximum number of bytes of the data field, which will depend on the CRYPTOS_LENGTH_HEADER_LEN bytes.  <a href="#a2288de8094acf582dca4ee1f0cdd2e97"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a20d6a01cb16dacc10ae93e08a17d4e4f">CRYPTOS_DEFAULT_DATA_SIZE</a>&nbsp;&nbsp;&nbsp;512</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the default size of the data field in crypto packets.  <a href="#a20d6a01cb16dacc10ae93e08a17d4e4f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a83449b187be07e92ad376998b548007d">CRYPTOS_MIN_DIGEST_LEN</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the size of the message digest algorithm which produces the minimum length digest, in bytes. Currently, CRC24.  <a href="#a83449b187be07e92ad376998b548007d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a4142ab5974d31fa8942a01954157d556">CRYPTOS_MAX_DIGEST_LEN</a>&nbsp;&nbsp;&nbsp;64</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the size of the message digest algorithm which produces the maximum length digest, in bytes. Currently, SHA512.  <a href="#a4142ab5974d31fa8942a01954157d556"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a92ab390999745403000d321f5d294c04">RATIO_DD</a>&nbsp;&nbsp;&nbsp;16</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the number of bytes of data per byte of message digest.  <a href="#a92ab390999745403000d321f5d294c04"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a7167887c2b9516515c63028ca184431b">CRYPTOS_BUFFER_MAX_SIZE</a>&nbsp;&nbsp;&nbsp;CRYPTOS_PACKET_MAX_LEN*2</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The max size, in bytes, of the cryptos buffer. It is set to twice the size of a cryptos packet because it'll never store two whole packets.  <a href="#a7167887c2b9516515c63028ca184431b"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#ab342f589e781ce06f945fb976a68b061">cryptos_buffer_init</a> (<a class="el" href="structcryptos__protocol__buffer__t.html">cryptos_protocol_buffer_t</a> *cb, int fd, size_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes cryptographic layer buffer.  <a href="#ab342f589e781ce06f945fb976a68b061"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a01580452cf8439df43896e83fd27656d">cryptos_buffer_free</a> (<a class="el" href="structcryptos__protocol__buffer__t.html">cryptos_protocol_buffer_t</a> *cb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Frees the resources allocated for the cryptographic layer buffer.  <a href="#a01580452cf8439df43896e83fd27656d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a64d6ea6588e5e6bc9011e92b2014f41f">cryptos_config_init</a> (<a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *cc, int cipher_algo, <a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *key, int keylen, int md_algo, int hmac, <a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *iv, int ivlen, uint64_t emission, uint64_t packet, uint64_t default_data_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes the internal variables of the <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> structure needed during the protocol.  <a href="#a64d6ea6588e5e6bc9011e92b2014f41f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a8ddf30d69f0d693857243682444a2bab">cryptos_config_free</a> (<a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *cc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Frees any internal variable of the structure.  <a href="#a8ddf30d69f0d693857243682444a2bab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a46675fbc652fcaf68c8ee63e52fef302">cryptos_config_set_key</a> (<a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *cc, <a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *key)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the key attribute of <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> to the key specified, freeing the previous iv when necessary.  <a href="#a46675fbc652fcaf68c8ee63e52fef302"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a421782f25372a747ff7024500a73ed79">cryptos_config_set_iv</a> (<a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *cc, <a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *iv)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the key attribute of <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> to the key specified, freeing the previous iv when necessary.  <a href="#a421782f25372a747ff7024500a73ed79"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#ac2e853bea1812472bc1688b1851af89a">produce_packet</a> (<a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *cc, <a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *data, uint64_t d_len, <a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *packet, uint64_t p_len, uint64_t *w_data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produces a new packet ready to be sent.  <a href="#ac2e853bea1812472bc1688b1851af89a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#ac1160b347f305764a4802a0301d5b8f1">parse_packet</a> (<a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *cc, <a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *packet, uint64_t p_len, <a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *data, uint64_t *d_len, uint64_t *r_data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parses the received data, returning the data in it.  <a href="#ac1160b347f305764a4802a0301d5b8f1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#af36e717fb86043efe61ac431efc62bb4">cryptos_key_init</a> (<a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *byte_key, const int size, <a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *key)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocates memory for the key fields and sets them to the received values.  <a href="#af36e717fb86043efe61ac431efc62bb4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a86d5045c3d909e3a1639bc623de0e652">cryptos_key_free</a> (<a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *key)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Frees the memory allocated for the internal variables of the given cryptos_key.  <a href="#a86d5045c3d909e3a1639bc623de0e652"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a434093aaf62efbc01205f4fa20b6bbda">cryptos_cipher_algo_code</a> (const char *cipher_algo_name, int *code)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the GCRY code for the algorithm with <em>cipher_algo_name</em> name. If the specified name is NULL, returns the code for ARCFOUR, which is the default cipher algorithm in this system.  <a href="#a434093aaf62efbc01205f4fa20b6bbda"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cryptos__channel_8h.html#a1e97f5628f332b4ab41812200be9b915">cryptos_md_algo_code</a> (const char *md_algo_name, int *code)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the GCRY code for the algorithm with <em>md_algo_name</em> name. If the specified name is NULL, returns the code for SHA1, which is the default message digest algorithm in this system.  <a href="#a1e97f5628f332b4ab41812200be9b915"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a7167887c2b9516515c63028ca184431b"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_BUFFER_MAX_SIZE" ref="a7167887c2b9516515c63028ca184431b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_BUFFER_MAX_SIZE&nbsp;&nbsp;&nbsp;CRYPTOS_PACKET_MAX_LEN*2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The max size, in bytes, of the cryptos buffer. It is set to twice the size of a cryptos packet because it'll never store two whole packets. </p>

</div>
</div>
<a class="anchor" id="a20d6a01cb16dacc10ae93e08a17d4e4f"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_DEFAULT_DATA_SIZE" ref="a20d6a01cb16dacc10ae93e08a17d4e4f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_DEFAULT_DATA_SIZE&nbsp;&nbsp;&nbsp;512</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the default size of the data field in crypto packets. </p>

</div>
</div>
<a class="anchor" id="a382386d5c1b47427e64124cfc65908fd"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_EMISSION_HEADER_LEN" ref="a382386d5c1b47427e64124cfc65908fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_EMISSION_HEADER_LEN&nbsp;&nbsp;&nbsp;sizeof(uint64_t)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the number of bytes of the EMISSION header field. </p>

</div>
</div>
<a class="anchor" id="a0a6fe10d58962c9689889c18376b7c92"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_IV_HEADER_LEN" ref="a0a6fe10d58962c9689889c18376b7c92" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_IV_HEADER_LEN&nbsp;&nbsp;&nbsp;16</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the number of bytes of the IV header field. </p>

</div>
</div>
<a class="anchor" id="a4b01da0a30c6c33719ba7a286d21843d"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_LENGTH_HEADER_LEN" ref="a4b01da0a30c6c33719ba7a286d21843d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_LENGTH_HEADER_LEN&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the number of bytes of the "length" header field. </p>

</div>
</div>
<a class="anchor" id="a2288de8094acf582dca4ee1f0cdd2e97"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_MAX_DATA" ref="a2288de8094acf582dca4ee1f0cdd2e97" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_MAX_DATA&nbsp;&nbsp;&nbsp;0xFFFFFFFF</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the maximum number of bytes of the data field, which will depend on the CRYPTOS_LENGTH_HEADER_LEN bytes. </p>

</div>
</div>
<a class="anchor" id="a4142ab5974d31fa8942a01954157d556"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_MAX_DIGEST_LEN" ref="a4142ab5974d31fa8942a01954157d556" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_MAX_DIGEST_LEN&nbsp;&nbsp;&nbsp;64</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the size of the message digest algorithm which produces the maximum length digest, in bytes. Currently, SHA512. </p>

</div>
</div>
<a class="anchor" id="a83449b187be07e92ad376998b548007d"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_MIN_DIGEST_LEN" ref="a83449b187be07e92ad376998b548007d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_MIN_DIGEST_LEN&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the size of the message digest algorithm which produces the minimum length digest, in bytes. Currently, CRC24. </p>

</div>
</div>
<a class="anchor" id="a984f884b4ca70914b046f647f0b77c55"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_PACKET_HEADER_LEN" ref="a984f884b4ca70914b046f647f0b77c55" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_PACKET_HEADER_LEN&nbsp;&nbsp;&nbsp;sizeof(uint64_t)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the number of bytes of the PACKET header field. </p>

</div>
</div>
<a class="anchor" id="a7c1db6bf9f40ac05ecbf951309023000"></a><!-- doxytag: member="cryptos_channel.h::CRYPTOS_SYNC_HEADER_LEN" ref="a7c1db6bf9f40ac05ecbf951309023000" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTOS_SYNC_HEADER_LEN&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the number of bytes of the SYNC header field. </p>

</div>
</div>
<a class="anchor" id="a92ab390999745403000d321f5d294c04"></a><!-- doxytag: member="cryptos_channel.h::RATIO_DD" ref="a92ab390999745403000d321f5d294c04" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RATIO_DD&nbsp;&nbsp;&nbsp;16</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines the number of bytes of data per byte of message digest. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a01580452cf8439df43896e83fd27656d"></a><!-- doxytag: member="cryptos_channel.h::cryptos_buffer_free" ref="a01580452cf8439df43896e83fd27656d" args="(cryptos_protocol_buffer_t *cb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_buffer_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__protocol__buffer__t.html">cryptos_protocol_buffer_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cb</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Frees the resources allocated for the cryptographic layer buffer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cb</em>&nbsp;</td><td>The cryptographic layer buffer structure to free</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno != 0 &amp;&amp; errno != EINVAL (see corresponding error code) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab342f589e781ce06f945fb976a68b061"></a><!-- doxytag: member="cryptos_channel.h::cryptos_buffer_init" ref="ab342f589e781ce06f945fb976a68b061" args="(cryptos_protocol_buffer_t *cb, int fd, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_buffer_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__protocol__buffer__t.html">cryptos_protocol_buffer_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes cryptographic layer buffer. </p>
<p>Initializes the internal variables of the <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> structure needed during the protocol.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cb</em>&nbsp;</td><td>The cryptographic layer buffer structure to initialize </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fd</em>&nbsp;</td><td>The file descriptor from which the cryptographic layer will retrieve the data to produce crypto packets </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>size</em>&nbsp;</td><td>The desired size of the buffer, in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno != 0 &amp;&amp; errno != EINVAL (see corresponding error code) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a434093aaf62efbc01205f4fa20b6bbda"></a><!-- doxytag: member="cryptos_channel.h::cryptos_cipher_algo_code" ref="a434093aaf62efbc01205f4fa20b6bbda" args="(const char *cipher_algo_name, int *code)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_cipher_algo_code </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>cipher_algo_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>code</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the GCRY code for the algorithm with <em>cipher_algo_name</em> name. If the specified name is NULL, returns the code for ARCFOUR, which is the default cipher algorithm in this system. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cipher_algo_name</em>&nbsp;</td><td>The name of the ciphering algorithm, in char* representation. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>code</em>&nbsp;</td><td>Variable to store the corresponding code.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8ddf30d69f0d693857243682444a2bab"></a><!-- doxytag: member="cryptos_channel.h::cryptos_config_free" ref="a8ddf30d69f0d693857243682444a2bab" args="(cryptos_config_t *cc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_config_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cc</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Frees any internal variable of the structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cc</em>&nbsp;</td><td>The crytpos config structure to free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a64d6ea6588e5e6bc9011e92b2014f41f"></a><!-- doxytag: member="cryptos_channel.h::cryptos_config_init" ref="a64d6ea6588e5e6bc9011e92b2014f41f" args="(cryptos_config_t *cc, int cipher_algo, byte *key, int keylen, int md_algo, int hmac, byte *iv, int ivlen, uint64_t emission, uint64_t packet, uint64_t default_data_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_config_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cipher_algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>md_algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>hmac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&nbsp;</td>
          <td class="paramname"> <em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ivlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>emission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>default_data_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes the internal variables of the <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> structure needed during the protocol. </p>
<p>Initializes the internal variables of the <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> structure needed during the protocol.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cc</em>&nbsp;</td><td>The <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> structure to initialize </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cipher_algo</em>&nbsp;</td><td>The cipher algorithm to use </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>The key to use, must have at least 16 bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>keylen</em>&nbsp;</td><td>Length of key, in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>md_algo</em>&nbsp;</td><td>The message digest algorithm </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hmac</em>&nbsp;</td><td>Boolean. When set, indicates the hmac variant of the md_algo wants to be used (if possible) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iv</em>&nbsp;</td><td>Initialization vector. It is not a key, but uses the same structure. Must have a length of 16 bytes (128 bits). Will be NULL at the receiver's side. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ivlen</em>&nbsp;</td><td>Length of iv, in bytes. Will be 0 at the receiver's side. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>emission</em>&nbsp;</td><td>Emission id </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>packet</em>&nbsp;</td><td>Packet id initial value. Will be 1 at the receiver's side. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>default_data_size</em>&nbsp;</td><td>Default data size, in bytes, to send in each packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno != 0 &amp;&amp; errno != EINVAL (see corresponding error code)</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a421782f25372a747ff7024500a73ed79"></a><!-- doxytag: member="cryptos_channel.h::cryptos_config_set_iv" ref="a421782f25372a747ff7024500a73ed79" args="(cryptos_config_t *cc, cryptos_key_t *iv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_config_set_iv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the key attribute of <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> to the key specified, freeing the previous iv when necessary. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cc</em>&nbsp;</td><td>The crytpos config structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iv</em>&nbsp;</td><td>The IV</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a46675fbc652fcaf68c8ee63e52fef302"></a><!-- doxytag: member="cryptos_channel.h::cryptos_config_set_key" ref="a46675fbc652fcaf68c8ee63e52fef302" args="(cryptos_config_t *cc, cryptos_key_t *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_config_set_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the key attribute of <a class="el" href="structcryptos__config__t.html" title="Defines the global configuration of the cryptographic protocol.">cryptos_config_t</a> to the key specified, freeing the previous iv when necessary. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cc</em>&nbsp;</td><td>The crytpos config structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a86d5045c3d909e3a1639bc623de0e652"></a><!-- doxytag: member="cryptos_channel.h::cryptos_key_free" ref="a86d5045c3d909e3a1639bc623de0e652" args="(cryptos_key_t *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_key_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Frees the memory allocated for the internal variables of the given cryptos_key. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>A pointer to the key to free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af36e717fb86043efe61ac431efc62bb4"></a><!-- doxytag: member="cryptos_channel.h::cryptos_key_init" ref="af36e717fb86043efe61ac431efc62bb4" args="(byte *byte_key, const int size, cryptos_key_t *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_key_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&nbsp;</td>
          <td class="paramname"> <em>byte_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcryptos__key__t.html">cryptos_key_t</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocates memory for the key fields and sets them to the received values. </p>
<p>Allocates memory for the key fields and sets them to the received values.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>byte_key</em>&nbsp;</td><td>The key value. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>size</em>&nbsp;</td><td>The size of the <em>byte_key</em> argument, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>A pointer to a previously allocated <a class="el" href="structcryptos__key__t.html" title="Defines the key structure to be used in the cryptographic layer.">cryptos_key_t</a> variable in which we'll store the key's members.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = ERANGE (invalid key size). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1e97f5628f332b4ab41812200be9b915"></a><!-- doxytag: member="cryptos_channel.h::cryptos_md_algo_code" ref="a1e97f5628f332b4ab41812200be9b915" args="(const char *md_algo_name, int *code)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptos_md_algo_code </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>md_algo_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>code</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the GCRY code for the algorithm with <em>md_algo_name</em> name. If the specified name is NULL, returns the code for SHA1, which is the default message digest algorithm in this system. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>md_algo_name</em>&nbsp;</td><td>The name of the digest algorithm, in char* representation. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>code</em>&nbsp;</td><td>Variable to store the corresponding code.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac1160b347f305764a4802a0301d5b8f1"></a><!-- doxytag: member="cryptos_channel.h::parse_packet" ref="ac1160b347f305764a4802a0301d5b8f1" args="(cryptos_config_t *cc, byte *packet, uint64_t p_len, byte *data, uint64_t *d_len, uint64_t *r_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&nbsp;</td>
          <td class="paramname"> <em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>p_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&nbsp;</td>
          <td class="paramname"> <em>d_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&nbsp;</td>
          <td class="paramname"> <em>r_data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Parses the received data, returning the data in it. </p>
<p>Parses the packet <em>packet</em>, of <em>p_len</em> bytes, using the cryptos context defined by <em>cc</em>, verifying it's integrity and that matches with the expected emission and packet IDs. If everything goes OK, the recoverd data will be stored in <em>data</em>, of <em>d_len</em> allocated bytes, which will be reallocated (and <em>d_len</em> updated consequently) if more space is needed. The total amount of pure data recoverd, in bytes, will be stored in <em>r_data</em>.</p>
<p>A packet will have the structure depicted below:</p>
<p>------------------------------------------------------------------------ | SYNC | DATA_LENGTH | IV | EMISSION_ID | PACKET_ID |.. DATA .. | DIGEST | ------------------------------------------------------------------------</p>
<ul>
<li>The field SYNC will be equal to CRYPTOS_SYNC_HEADER and will be of CRYPTOS_SYNC_HEADER_LEN bytes long.</li>
<li>The field DATA_LENGTH will mark the length of the field DATA and will be of CRYPTOS_LENGTH_HEADER_LEN bytes long.</li>
<li>The field IV will be of CRYPTOS_IV_LEN bytes</li>
<li>The field EMISSION_ID will be CRYPTOS_EMISSION_LEN bytes long</li>
<li>The field PACKET_ID will be CRYPTOS_PACKET_LEN bytes long</li>
<li>The field DATA will have the size marked in the DATA_LENGTH field</li>
<li>The DIGEST field will have a variable size, depending on the digest algorithm in use, and will vary from 24 bits (CRC24) to 64 bytes (SHA512) although high sizes are not likely to happen.</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cc</em>&nbsp;</td><td>Cryptos context. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>packet</em>&nbsp;</td><td>Packet to parse </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_len</em>&nbsp;</td><td>Allocated size, in bytes, for <em>packet</em> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Array to store the recovered data in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>d_len</em>&nbsp;</td><td>Allocated size, in bytes, for <em>data</em> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>r_data</em>&nbsp;</td><td>Final successfully recovered amount of data, in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno != 0 &amp;&amp; errno != EINVAL (see corresponding error code) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac2e853bea1812472bc1688b1851af89a"></a><!-- doxytag: member="cryptos_channel.h::produce_packet" ref="ac2e853bea1812472bc1688b1851af89a" args="(cryptos_config_t *cc, byte *data, uint64_t d_len, byte *packet, uint64_t p_len, uint64_t *w_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int produce_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcryptos__config__t.html">cryptos_config_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>d_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="global__types_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&nbsp;</td>
          <td class="paramname"> <em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>p_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&nbsp;</td>
          <td class="paramname"> <em>w_data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Produces a new packet ready to be sent. </p>
<p>Prepares a new packet ready to be sent. The data field will be ciphered and inserted in the packet. The header fields and integrity checks will be generated accordingly to the cryptos configuration received, and, upon successful execution, the packet id will be increased for the next packet.</p>
<p>A packet will have the structure depicted below:</p>
<p>------------------------------------------------------------------------ | SYNC | DATA_LENGTH | IV | EMISSION_ID | PACKET_ID |.. DATA .. | DIGEST | ------------------------------------------------------------------------</p>
<ul>
<li>The field SYNC will be equal to CRYPTOS_SYNC_HEADER and will be of CRYPTOS_SYNC_HEADER_LEN bytes long.</li>
<li>The field DATA_LENGTH will mark the length of the field DATA and will be of CRYPTOS_LENGTH_HEADER_LEN bytes long.</li>
<li>The field IV will be of CRYPTOS_IV_LEN bytes</li>
<li>The field EMISSION_ID will be CRYPTOS_EMISSION_LEN bytes long</li>
<li>The field PACKET_ID will be CRYPTOS_PACKET_LEN bytes long</li>
<li>The field DATA will have the size marked in the DATA_LENGTH field and will be the only field ciphered.</li>
<li>The DIGEST field will have a variable size, depending on the digest algorithm in use, and will vary from 24 bits (CRC24) to 64 bytes (SHA512) although high sizes are not likely to happen. The digest includes the whole packet except the SYNC field.</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cc</em>&nbsp;</td><td>Cryptos config structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The (plain) data to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>d_len</em>&nbsp;</td><td>The length of <em>data</em>, in bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>packet</em>&nbsp;</td><td>The byte array in which store the result </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_len</em>&nbsp;</td><td>The memory allocated for <em>packet</em>, in bytes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>w_data</em>&nbsp;</td><td>The number of data bytes successfuly included in the current packet. Note that the amount of received plain data can exceed the amount of data that can be included in the current packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding error code for integer returning functions, i.e., I_CRYPTOS_OK if no error was present and I_CRYPTOS_ERR if an error occured with errno updated. </dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_OK</em>&nbsp;</td><td>with errno = 0 (No error). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno = EINVAL (invalid argument). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I_CRYPTOS_ERR</em>&nbsp;</td><td>with errno != 0 &amp;&amp; errno != EINVAL (see corresponding error code) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Mon Aug 30 18:29:37 2010 for Steganography on Vorbis' audio streams by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
